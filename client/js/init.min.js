var scene;var camera;var renderer;var soundRenderer;var terrain;var light_dir1;var light_dir2;var light_dir3;var cube;var collision_map;var stats;var FOV=59;var model_red;var model_blue;var model_bull;function InitModels(){var c="resources/models/daleks/";var a="Dalek";NumOfLoadingModels++;var b=new THREE.LoadingManager();var e=new THREE.MTLLoader();e.setPath(c);e.load(a+"_red.mtl",function(g){g.preload();var f=new THREE.OBJLoader(b);f.setMaterials(g);f.setPath(c);f.load(a+".obj",function(h){h.traverse(function(i){if(i instanceof THREE.Mesh){i.castShadow=true;i.receiveShadow=true}});h.scale.x=0.1;h.scale.y=0.1;h.scale.z=0.1;NumOfLoadingModels--;model_red=h;InitFinish()})});NumOfLoadingModels++;e.setPath(c);e.load(a+"_blue.mtl",function(g){g.preload();var f=new THREE.OBJLoader(b);f.setMaterials(g);f.setPath(c);f.load(a+".obj",function(h){h.traverse(function(i){if(i instanceof THREE.Mesh){i.castShadow=true;i.receiveShadow=true}});h.scale.x=0.1;h.scale.y=0.1;h.scale.z=0.1;NumOfLoadingModels--;model_blue=h;InitFinish()})});var d=new THREE.MeshBasicMaterial({color:13369344});model_bull=new THREE.Mesh(new THREE.SphereGeometry(0.59,5,5),d);model_bull.position.y=17}function InitSkybox(){var g=["xpos","xneg","ypos","yneg","zpos","zneg"];for(var c=0;c<6;c++){g[c]="././resources/textures/skybox/"+g[c]+".png"}var a=new THREE.CubeTextureLoader();var f=a.load(g);f.format=THREE.RGBFormat;var d=THREE.ShaderLib.cube;d.uniforms.tCube.value=f;var b=new THREE.ShaderMaterial({fragmentShader:d.fragmentShader,vertexShader:d.vertexShader,uniforms:d.uniforms,depthWrite:false,side:THREE.BackSide});var e=new THREE.Mesh(new THREE.CubeGeometry(10000,10000,10000),b);scene.add(e)}function InitTerrain(){var c="resources/models/mineways/mirage/";var a="mirage";var b=new THREE.LoadingManager();var d=new THREE.MTLLoader();NumOfLoadingModels++;d.setPath(c);d.load(a+".mtl",function(f){f.magFilter=THREE.NearestFilter;f.minFilter=THREE.LinearMipMapLinearFilter;f.preload();var e=new THREE.OBJLoader(b);e.setMaterials(f);e.setPath(c);e.load(a+".obj",function(g){g.traverse(function(h){if(h instanceof THREE.Mesh){h.castShadow=true;h.receiveShadow=true}});g.scale.x=74;g.scale.y=74;g.scale.z=74;g.position.y=-95;g.position.x=410;g.position.z=322;terrain=g;NumOfLoadingModels--;scene.add(terrain);InitFinish()})})}var NumOfLoadingModels=0;function InitFinish(){if(NumOfLoadingModels>0){return}ConnectionInit()}function Init(){stats=new Stats();stats.showPanel(0);document.body.appendChild(stats.dom);document.body.style.cursor="default";scene=new THREE.Scene();SoundInit("./resources/sounds/space_laser_shot.mp3");camera=new THREE.PerspectiveCamera(FOV,window.innerWidth/window.innerHeight,0.1,10000);renderer=new THREE.WebGLRenderer();renderer.setClearColor(1,255);renderer.setSize(window.innerWidth,window.innerHeight);renderer.shadowMap.enabled=true;cube=new THREE.Mesh(new THREE.CubeGeometry(30,30,30),new THREE.MeshNormalMaterial());light_dir1=new THREE.DirectionalLight(16777215,0.9);light_dir1.position.set(1,1,1);light_dir2=new THREE.DirectionalLight(16777215,0.9);light_dir2.position.set(-1,1,-1);light_dir3=new THREE.DirectionalLight(16777215,0.3);light_dir3.position.set(0,-1,0);scene.add(light_dir1);scene.add(light_dir2);scene.add(light_dir3);var a=new THREE.ImageLoader();a.load("./resources/models/mineways/mirage/cmap_merged_kek.png",function(b){collision_map=getImageData(b)});InitModels();InitTerrain();InitSkybox();$("#canvas").append(renderer.domElement)};