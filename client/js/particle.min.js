var particles=[];function AddParticle(b,c,a){particles.push(new Particle("blue",b.clone(),c.clone(),a))}function UpdatePatricles(){particles.forEach(function(a,b,c){a.Update();if(a.dead){scene.remove(a.particleSystem);delete particles[b]}})}function Particle(f,c,g,b){this.time=0;this.dead=false;this.lifetime=b*50;this.particleCount=30;this.particles=new THREE.Geometry();this.directions=[];var a=new THREE.TextureLoader();var e=new THREE.PointsMaterial({color:16777215,size:3,map:a.load("./resources/textures/particles/"+f+"_particle.jpg"),blending:THREE.AdditiveBlending,transparent:true});for(var d=0;d<this.particleCount;d++){this.directions.push(VecSet3(g.x*5,g.y*5,g.z*5));var h=new THREE.Vector3(c.x+g.x*(d/3+5),c.y+g.y+17.5,c.z+g.z*(d/3+5));this.particles.vertices.push(h)}this.particleSystem=new THREE.Points(this.particles,e);this.particleSystem.sortParticles=true;scene.add(this.particleSystem)}Particle.prototype.Update=function(){for(var a=0;a<this.particleCount;a++){this.particles.vertices[a].add(this.directions[a].clone())}this.particleSystem.geometry.verticesNeedUpdate=true;this.particleSystem.sortParticles=true;if(this.time++>=this.lifetime){this.dead=true}};