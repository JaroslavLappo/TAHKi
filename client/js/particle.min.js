var particles=[];function AddParticle(b,d,a){var c=0;while(particles[c]!=undefined){c++}particles[c]=new Particle("blue",b,d,a)}function UpdatePatricles(){for(var a=0;a<particles.length;a++){if(particles[a]!=undefined){particles[a].Update();if(particles[a].dead){delete particles[a]}}}}function Particle(f,c,g,b){this.time=0;this.dead=false;this.lifetime=b*50;this.particleCount=30;this.particles=new THREE.Geometry();this.directions=[];var a=new THREE.TextureLoader();var e=new THREE.PointsMaterial({color:16777215,size:2,map:a.load("./resources/textures/particles/"+f+"_particle.jpg"),blending:THREE.AdditiveBlending,transparent:true});for(var d=0;d<this.particleCount;d++){this.directions.push(VecSet3(g.x*2+Math.random()/100-0.005,g.y*2+Math.random()/100-0.005,g.z*2+Math.random()/100-0.005));var h=new THREE.Vector3(c.x+g.x+Math.random()*0.05-0.025,c.y+g.x+Math.random()*0.05-0.025+18,c.z+g.z+Math.random()*0.05-0.025);this.particles.vertices.push(h)}this.particleSystem=new THREE.Points(this.particles,e);this.particleSystem.sortParticles=true;scene.add(this.particleSystem)}Particle.prototype.Update=function(){for(var a=0;a<this.particleCount;a++){this.particles.vertices[a].add(this.directions[a].clone())}this.particleSystem.geometry.verticesNeedUpdate=true;if(this.time++>=this.lifetime){this.dead=true}};